<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Initializes a new fanotify group and returns a file descriptor for the event queue associated with the group."><meta name="keywords" content="rust, rustlang, rust-lang, fanotify_init"><title>fanotify_init in naughtyfy::low_api - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../naughtyfy/index.html"><div class="logo-container"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../naughtyfy/index.html"><div class="logo-container"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><div class="sidebar-elems"><h2><a href="index.html">In naughtyfy::low_api</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Function <a href="../index.html">naughtyfy</a>::<wbr><a href="index.html">low_api</a>::<wbr><a class="fn" href="#">fanotify_init</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/naughtyfy/low_api.rs.html#59-70">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><div class="item-decl"><pre class="rust fn"><code>pub fn fanotify_init(flags: <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.u32.html">u32</a>, event_f_flags: <a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.u32.html">u32</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.67.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.67.1/std/primitive.i32.html">i32</a>, <a class="struct" href="https://doc.rust-lang.org/1.67.1/std/io/error/struct.Error.html" title="struct std::io::error::Error">Error</a>&gt;</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Initializes a new fanotify group and returns a file descriptor for the event queue associated with the group.<br/></p>
<p>The file descriptor is used in calls to fanotify_mark(2) to specify the files, directories, mounts or filesystems for which fanotify events shall be created.<br />
These events are received by reading from the file descriptor.  <br/>
Some events are only informative, indicating that a file has been accessed.
Other events can be used to determine whether another application is permitted to access a file or directory.
Permission to access filesystem objects is granted by writing to the file descriptor.
Multiple programs may be using the fanotify interface at the same time to monitor the same files.<br/>
In the current implementation, the number of fanotify groups per user is limited to 128.  This limit cannot be overridden.
Calling fanotify_init() requires the CAP_SYS_ADMIN capability.<br />
This constraint might be relaxed in future versions of the API. <br/>
Therefore, certain additional capability checks have been implemented as indicated below.<br/>
The <code>flags</code> argument contains a multi-bit field defining the notification class of the listening application and further single bit fields specifying the behavior of the file descriptor.<br/>
If multiple listeners for permission events exist, the notification class is used to establish the sequence in which the listeners receive the events.<br/></p>
<p>Only one of the following notification classes may be specified in <code>flags</code>:<br/></p>
<ul>
<li>FAN_CLASS_PRE_CONTENT</li>
<li>FAN_CLASS_CONTENT</li>
<li>FAN_CLASS_NOTIF</li>
</ul>
<p>Listeners with different notification classes will receive events in the order <code>FAN_CLASS_PRE_CONTENT</code>, <code>FAN_CLASS_CONTENT</code>, <code>FAN_CLASS_NOTIF</code>.
The order of notification for listeners in the same notification class is undefined.<br/>
The following bits can additionally be set in flags:<br/></p>
<ul>
<li>FAN_CLOEXEC</li>
<li>FAN_NONBLOCK</li>
<li>FAN_UNLIMITED_QUEUE</li>
<li>FAN_UNLIMITED_MARKS</li>
<li>FAN_REPORT_TID (since Linux 4.20)</li>
<li>FAN_REPORT_FID (since Linux 5.1)</li>
</ul>
<p>The event_f_flags argument defines the file status flags that will be set on the open file descriptions that are created for fanotify events.  <br/>
For details of these flags, see the description of the flags values in open(2).  event_f_flags includes a multi-bit field for the access mode.  <br/>
This field can take the following values:</p>
<ul>
<li>O_RDONLY</li>
<li>O_WRONLY</li>
<li>O_RDWR</li>
</ul>
<p>Additional bits can be set in event_f_flags.  The most useful values are:</p>
<ul>
<li>O_LARGEFILE</li>
<li>O_CLOEXEC (since Linux 3.18)</li>
</ul>
<p>The following are also allowable: <code>O_APPEND</code>, <code>O_DSYNC</code>, <code>O_NOATIME</code>,<code>O_NONBLOCK</code>, and <code>O_SYNC</code>.  Specifying any other flag in <code>event_f_flags</code> yields the error <code>EINVAL</code>.</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>naughtyfy::low_layer::<span class="kw-2">*</span>;
<span class="kw">let </span>fd = fanotify_init(FAN_CLASS_NOTIF, O_RDONLY).unwrap();
<span class="macro">assert!</span>(fd &gt; <span class="number">0</span>)</code></pre></div>
</div></details></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="naughtyfy" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.1 (d5a82bbd2 2023-02-07)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>