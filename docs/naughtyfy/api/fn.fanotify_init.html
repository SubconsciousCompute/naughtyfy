<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Initializes a new fanotify group and returns a file descriptor for the event queue associated with the group."><meta name="keywords" content="rust, rustlang, rust-lang, fanotify_init"><title>fanotify_init in naughtyfy::api - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../naughtyfy/index.html"><div class="logo-container"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../naughtyfy/index.html"><div class="logo-container"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><div class="sidebar-elems"><h2><a href="index.html">In naughtyfy::api</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Function <a href="../index.html">naughtyfy</a>::<wbr><a href="index.html">api</a>::<wbr><a class="fn" href="#">fanotify_init</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/naughtyfy/api.rs.html#95-102">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><div class="item-decl"><pre class="rust fn"><code>pub fn fanotify_init(flags: <a class="primitive" href="https://doc.rust-lang.org/1.67.0/std/primitive.u32.html">u32</a>, event_f_flags: <a class="primitive" href="https://doc.rust-lang.org/1.67.0/std/primitive.u32.html">u32</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.67.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.67.0/std/primitive.i32.html">i32</a>, <a class="struct" href="https://doc.rust-lang.org/1.67.0/std/io/error/struct.Error.html" title="struct std::io::error::Error">Error</a>&gt;</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Initializes a new fanotify group and returns a
file descriptor for the event queue associated with the group.</p>
<p>The file descriptor is used in calls to <a href="fn.fanotify_mark.html" title="fanotify_mark()"><code>fanotify_mark()</code></a> to
specify the files, directories, mounts, or filesystems for which
fanotify events shall be created.  These events are received by
reading from the file descriptor.  Some events are only
informative, indicating that a file has been accessed.  Other
events can be used to determine whether another application is
permitted to access a file or directory.  Permission to access
filesystem objects is granted by writing to the file descriptor.</p>
<p>Multiple programs may be using the fanotify interface at the same
time to monitor the same files.</p>
<p>In the current implementation, the number of fanotify groups per
user is limited to 128.  This limit cannot be overridden.</p>
<p>Calling <a href="fn.fanotify_init.html" title="fanotify_init()"><code>fanotify_init()</code></a> requires the <code>CAP_SYS_ADMIN</code> capability.
This constraint might be relaxed in future versions of the API.
Therefore, certain additional capability checks have been
implemented as indicated below.</p>
<p>The flags argument contains a multi-bit field defining the
notification class of the listening application and further
single bit fields specifying the behavior of the file descriptor.</p>
<p>If multiple listeners for permission events exist, the
notification class is used to establish the sequence in which the
listeners receive the events.</p>
<h2 id="arguments"><a href="#arguments">Arguments</a></h2>
<ul>
<li>
<p><code>flags</code> - Sets the notification group, can be mask of <br></p>
<ul>
<li><a href="../flags/constant.FAN_CLASS_PRE_CONTENT.html" title="FAN_CLASS_PRE_CONTENT"><code>FAN_CLASS_PRE_CONTENT</code></a></li>
<li><a href="../flags/constant.FAN_CLASS_CONTENT.html" title="FAN_CLASS_CONTENT"><code>FAN_CLASS_CONTENT</code></a></li>
<li><a href="../flags/constant.FAN_CLASS_NOTIF.html" title="FAN_CLASS_NOTIF"><code>FAN_CLASS_NOTIF</code></a></li>
</ul>
<p>The following bits can additionally be set in <code>flags</code>: <br></p>
<ul>
<li><a href="../flags/constant.FAN_CLOEXEC.html" title="FAN_CLOEXEC"><code>FAN_CLOEXEC</code></a></li>
<li><a href="../flags/constant.FAN_NONBLOCK.html" title="FAN_NONBLOCK"><code>FAN_NONBLOCK</code></a></li>
<li><a href="../flags/constant.FAN_UNLIMITED_QUEUE.html" title="FAN_UNLIMITED_QUEUE"><code>FAN_UNLIMITED_QUEUE</code></a></li>
<li><a href="../flags/constant.FAN_UNLIMITED_MARKS.html" title="FAN_UNLIMITED_MARKS"><code>FAN_UNLIMITED_MARKS</code></a></li>
<li><a href="../flags/constant.FAN_ENABLE_AUDIT.html" title="FAN_ENABLE_AUDIT"><code>FAN_ENABLE_AUDIT</code></a></li>
<li><a href="../flags/constant.FAN_REPORT_FID.html" title="FAN_REPORT_FID"><code>FAN_REPORT_FID</code></a></li>
<li><a href="../flags/constant.FAN_REPORT_DIR_FID.html" title="FAN_REPORT_DIR_FID"><code>FAN_REPORT_DIR_FID</code></a></li>
<li><a href="../flags/constant.FAN_REPORT_NAME.html" title="FAN_REPORT_NAME"><code>FAN_REPORT_NAME</code></a></li>
<li><a href="../flags/constant.FAN_REPORT_DFID_NAME.html" title="FAN_REPORT_DFID_NAME"><code>FAN_REPORT_DFID_NAME</code></a></li>
</ul>
</li>
<li>
<p><code>event_f_flags</code> - Defines the file status flags that
will be set on the open file descriptions that are created for
fanotify events.  For details of these flags, see the description
of the flags values in open(2).  <code>event_f_flags</code> includes a multi-
bit field for the access mode. This field can take the following
values:</p>
<ul>
<li><a href="../flags/constant.O_RDONLY.html" title="O_RDONLY"><code>O_RDONLY</code></a></li>
<li><a href="../flags/constant.O_WRONLY.html" title="O_WRONLY"><code>O_WRONLY</code></a></li>
<li><a href="../flags/constant.O_RDWR.html" title="O_RDWR"><code>O_RDWR</code></a></li>
</ul>
<p>Additional bits can be set in <code>event_f_flags</code>.</p>
<ul>
<li><a href="../flags/constant.O_LARGEFILE.html" title="O_LARGEFILE"><code>O_LARGEFILE</code></a></li>
<li><a href="../flags/constant.O_CLOEXEC.html" title="O_CLOEXEC"><code>O_CLOEXEC</code></a></li>
<li><a href="../flags/constant.O_APPEND.html" title="O_APPEND"><code>O_APPEND</code></a></li>
<li><a href="../flags/constant.O_DSYNC.html" title="O_DSYNC"><code>O_DSYNC</code></a></li>
<li><a href="../flags/constant.O_NOATIME.html" title="O_NOATIME"><code>O_NOATIME</code></a></li>
<li><a href="../flags/constant.O_NONBLOCK.html" title="O_NONBLOCK"><code>O_NONBLOCK</code></a></li>
</ul>
</li>
</ul>
<h2 id="example"><a href="#example">Example</a></h2>
<p>This example will panic due to absence of <code>CAP_SYS_ADMIN</code> <a href="https://man7.org/linux/man-pages/man7/capabilities.7.html">capabilitity</a></p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>fd = fanotify_init(FAN_CLASS_NOTIF | FAN_NONBLOCK, O_RDONLY);</code></pre></div>
</div></details></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="naughtyfy" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.0 (fc594f156 2023-01-24)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>